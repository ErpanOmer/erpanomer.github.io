---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { Code } from "astro:components";

const code = `import { generateFingerprint } from './sdk.js';

// ç”ŸæˆæŒ‡çº¹
const result = await generateFingerprint({
  canvas: true,   // å¯ç”¨ Canvas æŒ‡çº¹
  audio: true,    // å¯ç”¨ Audio æŒ‡çº¹
  webgl: true,    // å¯ç”¨ WebGL æŒ‡çº¹ (æ–°å¢)
  fonts: true,    // å¯ç”¨å­—ä½“æ£€æµ‹ (æ–°å¢)
  hardware: true, // å¯ç”¨ç¡¬ä»¶ç‰¹å¾
});

console.log(result.deviceId); 
// è¾“å‡º: "84e1b..." (16ä½ç¨³å®šå”¯ä¸€ ID)`;
---

<BaseLayout
    title="è®¾å¤‡æŒ‡çº¹ç”Ÿæˆå™¨ (Device Fingerprint) | ErpanOmer"
    description="åŸºäºæµè§ˆå™¨ç‰¹å¾ç”Ÿæˆçš„çº¯å‰ç«¯è®¾å¤‡å”¯ä¸€æ ‡è¯† IDã€‚æ—  Cookieã€æ— ç¼“å­˜ã€æ— æƒé™è¯·æ±‚ï¼Œéšç§å®‰å…¨ã€‚"
>
    <div
        class="relative min-h-screen overflow-hidden bg-slate-900 text-slate-100 font-sans selection:bg-cyan-500/30"
    >
        <!-- Background Effects -->
        <div
            class="absolute top-0 left-0 w-full h-96 bg-gradient-to-b from-cyan-900/20 to-transparent pointer-events-none"
        >
        </div>
        <div
            class="absolute -top-40 -right-40 w-96 h-96 bg-indigo-600/20 rounded-full blur-3xl pointer-events-none animate-pulse"
        >
        </div>
        <div
            class="absolute bottom-0 left-20 w-72 h-72 bg-emerald-600/10 rounded-full blur-3xl pointer-events-none"
        >
        </div>

        <div class="relative max-w-5xl mx-auto px-4 py-12 sm:px-6 lg:px-8">
            <!-- Header -->
            <div class="text-center mb-16">
                <h1
                    class="text-4xl md:text-5xl font-extrabold tracking-tight mb-4 bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 via-sky-400 to-indigo-400"
                >
                    è®¾å¤‡æŒ‡çº¹ç”Ÿæˆå™¨
                </h1>
                <p class="max-w-2xl mx-auto text-lg text-slate-400">
                    ä»…åˆ©ç”¨æµè§ˆå™¨ç‰¹å¾ç”Ÿæˆç¨³å®šã€å”¯ä¸€çš„è®¾å¤‡ IDã€‚
                    <br />
                    <span class="text-cyan-400 font-medium"
                        >æ—  Cookie Â· æ—  LocalStorage Â· é›¶æƒé™è·å–</span
                    >
                </p>
            </div>

            <!-- Main Action Card -->
            <div
                class="bg-slate-800/50 backdrop-blur-xl rounded-3xl border border-slate-700/50 px-4 py-8 md:p-12 shadow-2xl mb-12 ring-1 ring-white/10"
            >
                <div
                    class="flex flex-col items-center justify-center space-y-8"
                >
                    <!-- ID Display -->
                    <div
                        id="result-container"
                        class="w-full max-w-3xl text-center hidden opacity-0 transition-all duration-700 transform translate-y-4"
                    >
                        <div
                            class="uppercase tracking-widest text-xs font-semibold text-slate-500 mb-2"
                        >
                            Unique Device Identifier
                        </div>
                        <div class="relative group">
                            <div
                                class="absolute -inset-1 bg-gradient-to-r from-cyan-500 to-indigo-500 rounded-xl blur opacity-25 group-hover:opacity-50 transition duration-500"
                            >
                            </div>
                            <div
                                id="device-id-display"
                                class="relative bg-slate-900 rounded-xl px-4 py-6 md:py-8 break-all font-mono text-xl md:text-4xl text-cyan-50 tracking-wider shadow-inner border border-slate-700"
                            >
                                <span
                                    class="animate-pulse text-slate-500 text-sm"
                                    >æ­£åœ¨è®¡ç®—è®¾å¤‡æŒ‡çº¹...</span
                                >
                            </div>
                            <button
                                id="copy-btn"
                                class="absolute right-4 top-1/2 -translate-y-1/2 p-2 text-slate-500 hover:text-cyan-400 transition-colors"
                                title="å¤åˆ¶ ID"
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="20"
                                    height="20"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    ><rect
                                        x="9"
                                        y="9"
                                        width="13"
                                        height="13"
                                        rx="2"
                                        ry="2"></rect><path
                                        d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"
                                    ></path></svg
                                >
                            </button>
                        </div>

                        <div
                            class="flex justify-center gap-6 mt-6 text-sm text-slate-400 font-mono"
                        >
                            <div title="ç†µå€¼è¶Šé«˜ï¼Œå”¯ä¸€æ€§è¶Šå¼º">
                                <span>ç†µå€¼ä¼°è®¡:</span>
                                <span
                                    id="entropy-score"
                                    class="text-emerald-400 font-bold">--</span
                                > bits
                            </div>
                            <div>
                                <span>ç”Ÿæˆè€—æ—¶:</span>
                                <span
                                    id="gen-time"
                                    class="text-indigo-400 font-bold">--</span
                                > ms
                            </div>
                        </div>
                    </div>

                    <!-- Generate Button (Optional Manual Trigger) -->
                    <button
                        id="generate-btn"
                        class="text-sm text-slate-400 hover:text-cyan-400 transition-colors underline decoration-dotted underline-offset-4 hidden"
                    >
                        é‡æ–°ç”Ÿæˆ
                    </button>
                </div>

                <!-- Components Breakdown -->
                <div
                    id="breakdown-grid"
                    class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-12 opacity-0 transition-all duration-700 delay-200 md:items-stretch"
                >
                    <!-- Canvas Module -->
                    <div
                        class="bg-slate-900/60 p-6 rounded-2xl border border-slate-700 backdrop-blur-sm hover:border-cyan-500/30 transition-colors flex flex-col"
                    >
                        <div class="flex items-center gap-3 mb-4">
                            <div
                                class="p-2 bg-orange-500/10 rounded-lg text-orange-400"
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="20"
                                    height="20"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    ><rect
                                        width="18"
                                        height="18"
                                        x="3"
                                        y="3"
                                        rx="2"
                                        ry="2"></rect><circle
                                        cx="8.5"
                                        cy="8.5"
                                        r="1.5"></circle><path
                                        d="m20.4 14.5-2.9-2.9a2.5 2.5 0 0 0-3.5 0l-7 7"
                                    ></path></svg
                                >
                            </div>
                            <h3 class="font-bold text-slate-200">
                                Canvas æŒ‡çº¹
                            </h3>
                        </div>
                        <div
                            class="prose prose-invert text-xs text-slate-400 mb-3"
                        >
                            é€šè¿‡åœ¨éšè—ç”»å¸ƒä¸Šç»˜åˆ¶æ··åˆå­—ä½“ã€Emoji
                            å’Œæ··åˆæ¨¡å¼å›¾å½¢ï¼Œæ•æ‰ä¸åŒ GPU å’Œ æ¸²æŸ“å¼•æ“çš„ç»†å¾®å·®å¼‚ã€‚
                        </div>
                        <div
                            class="flex-1 bg-white/5 rounded-lg flex items-center justify-center overflow-hidden border border-white/10"
                        >
                            <img
                                id="signal-canvas-img"
                                src=""
                                alt="Canvas Fingerprint"
                                class="max-w-full max-h-full opacity-80"
                            />
                        </div>
                        <div class="mt-2 text-right">
                            <span
                                class="text-[10px] text-slate-500 font-mono"
                                id="signal-canvas-hash"></span>
                        </div>
                    </div>

                    <!-- Audio Module -->
                    <div
                        class="bg-slate-900/60 p-6 rounded-2xl border border-slate-700 backdrop-blur-sm hover:border-indigo-500/30 transition-colors flex flex-col"
                    >
                        <div class="flex items-center gap-3 mb-4">
                            <div
                                class="p-2 bg-indigo-500/10 rounded-lg text-indigo-400"
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="20"
                                    height="20"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    ><path d="M2 10v3"></path><path d="M6 6v11"
                                    ></path><path d="M10 3v18"></path><path
                                        d="M14 8v7"></path><path d="M18 5v13"
                                    ></path><path d="M22 10v3"></path></svg
                                >
                            </div>
                            <h3 class="font-bold text-slate-200">Audio æŒ‡çº¹</h3>
                        </div>
                        <div
                            class="prose prose-invert text-xs text-slate-400 mb-3"
                        >
                            åˆ©ç”¨ OfflineAudioContext
                            æ¸²æŸ“æ— å£°æŒ¯è¡æ³¢å½¢å¹¶è¿›è¡Œå‹ç¼©ï¼Œæ•æ‰éŸ³é¢‘ç¡¬ä»¶åŠé©±åŠ¨çš„ç‰¹å¾å·®å¼‚ã€‚
                        </div>
                        <div
                            class="min-h-24 flex-1 flex items-end justify-center gap-1 pb-4 px-4 bg-white/5 rounded-lg border border-white/10"
                        >
                            <div
                                class="flex-1 bg-indigo-500/50 animate-pulse"
                                style="height: 20%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/60 animate-pulse delay-75"
                                style="height: 35%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/70 animate-pulse delay-100"
                                style="height: 45%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/80 animate-pulse delay-150"
                                style="height: 60%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/90 animate-pulse delay-200"
                                style="height: 75%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/70 animate-pulse delay-75"
                                style="height: 55%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/60 animate-pulse delay-100"
                                style="height: 40%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/50 animate-pulse delay-150"
                                style="height: 25%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/60 animate-pulse delay-200"
                                style="height: 30%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/80 animate-pulse"
                                style="height: 65%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/90 animate-pulse delay-75"
                                style="height: 70%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/70 animate-pulse delay-100"
                                style="height: 50%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/60 animate-pulse delay-150"
                                style="height: 35%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/50 animate-pulse delay-200"
                                style="height: 18%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/60 animate-pulse"
                                style="height: 28%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/70 animate-pulse delay-75"
                                style="height: 42%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/80 animate-pulse delay-100"
                                style="height: 58%"
                            >
                            </div>
                            <div
                                class="flex-1 bg-indigo-500/50 animate-pulse delay-150"
                                style="height: 15%"
                            >
                            </div>
                        </div>
                        <div class="mt-2 text-right">
                            <span
                                class="text-[10px] text-slate-500 font-mono"
                                id="signal-audio-hash">ç­‰å¾…ç”Ÿæˆ...</span
                            >
                        </div>
                    </div>

                    <!-- Hardware Module -->
                    <div
                        class="bg-slate-900/60 p-6 rounded-2xl border border-slate-700 backdrop-blur-sm hover:border-emerald-500/30 transition-colors flex flex-col"
                    >
                        <div class="flex items-center gap-3 mb-4">
                            <div
                                class="p-2 bg-emerald-500/10 rounded-lg text-emerald-400"
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="20"
                                    height="20"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    ><rect
                                        x="2"
                                        y="3"
                                        width="20"
                                        height="14"
                                        rx="2"
                                        ry="2"></rect><line
                                        x1="8"
                                        y1="21"
                                        x2="16"
                                        y2="21"></line><line
                                        x1="12"
                                        y1="17"
                                        x2="12"
                                        y2="21"></line></svg
                                >
                            </div>
                            <h3 class="font-bold text-slate-200">ç¡¬ä»¶ç‰¹å¾</h3>
                        </div>
                        <div
                            class="prose prose-invert text-xs text-slate-400 mb-3"
                        >
                            ç»¼åˆ CPU
                            æ ¸å¿ƒå¹¶å‘æ•°ã€è®¾å¤‡å†…å­˜ã€ç³»ç»Ÿè¯­è¨€ã€æ—¶åŒºç­‰ç›¸å¯¹ç¨³å®šçš„ç¡¬ä»¶ç‰¹å¾ã€‚
                        </div>
                        <div
                            class="flex flex-col px-3 py-2 bg-white/5 rounded-lg border border-white/10 text-xs font-mono text-slate-300 space-y-1.5 scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-transparent"
                        >
                            <div
                                id="hw-cores"
                                class="flex justify-between gap-2"
                            >
                                <span class="text-slate-500">æ ¸å¿ƒæ•°:</span>
                                <span class="text-emerald-400">--</span>
                            </div>
                            <div id="hw-mem" class="flex justify-between gap-2">
                                <span class="text-slate-500">å†…å­˜:</span>
                                <span class="text-emerald-400">--</span>
                            </div>
                            <div
                                id="hw-platform"
                                class="flex justify-between gap-2"
                            >
                                <span class="text-slate-500">å¹³å°:</span>
                                <span class="text-emerald-400">--</span>
                            </div>
                            <div
                                id="hw-language"
                                class="flex justify-between gap-2"
                            >
                                <span class="text-slate-500">è¯­è¨€:</span>
                                <span class="text-emerald-400">--</span>
                            </div>
                            <div
                                id="hw-colordepth"
                                class="flex justify-between gap-2"
                            >
                                <span class="text-slate-500">è‰²æ·±:</span>
                                <span class="text-emerald-400">--</span>
                            </div>
                            <div
                                id="hw-pixeldepth"
                                class="flex justify-between gap-2"
                            >
                                <span class="text-slate-500">åƒç´ æ·±åº¦:</span>
                                <span class="text-emerald-400">--</span>
                            </div>
                            <div
                                id="hw-timezone"
                                class="flex justify-between gap-2"
                            >
                                <span class="text-slate-500">æ—¶åŒºåç§»:</span>
                                <span class="text-emerald-400">--</span>
                            </div>
                        </div>
                    </div>

                    <!-- WebGL Module -->
                    <div
                        class="bg-slate-900/60 p-6 rounded-2xl border border-slate-700 backdrop-blur-sm hover:border-purple-500/30 transition-colors flex flex-col"
                    >
                        <div class="flex items-center gap-3 mb-4">
                            <div
                                class="p-2 bg-purple-500/10 rounded-lg text-purple-400"
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="20"
                                    height="20"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    ><path d="M12 2L2 7l10 5 10-5-10-5z"
                                    ></path><path d="M2 17l10 5 10-5"
                                    ></path><path d="M2 12l10 5 10-5"
                                    ></path></svg
                                >
                            </div>
                            <h3 class="font-bold text-slate-200">WebGL æŒ‡çº¹</h3>
                        </div>
                        <div
                            class="prose prose-invert text-xs text-slate-400 mb-3"
                        >
                            è·å– GPU ä¾›åº”å•†ã€æ¸²æŸ“å™¨å‹å·åŠ WebGL
                            å‚æ•°ï¼Œæ•æ‰æ˜¾å¡ç¡¬ä»¶ç‰¹å¾ã€‚
                        </div>
                        <div
                            class="flex-1 flex flex-col px-3 py-2 bg-white/5 rounded-lg border border-white/10 text-xs font-mono text-slate-300 space-y-1 whitespace-normal"
                        >
                            <div
                                id="webgl-vendor"
                                class="truncate whitespace-normal"
                            >
                                <span class="text-slate-500">ä¾›åº”å•†:</span>
                                <span class="text-purple-400 whitespace-normal"
                                    >--</span
                                >
                            </div>
                            <div
                                id="webgl-renderer"
                                class="truncate whitespace-normal"
                            >
                                <span class="text-slate-500">æ¸²æŸ“å™¨:</span>
                                <span class="text-purple-400">--</span>
                            </div>
                        </div>
                    </div>

                    <!-- Font Detection Module -->
                    <div
                        class="bg-slate-900/60 p-6 rounded-2xl border border-slate-700 backdrop-blur-sm hover:border-pink-500/30 transition-colors flex flex-col"
                    >
                        <div class="flex items-center gap-3 mb-4">
                            <div
                                class="p-2 bg-pink-500/10 rounded-lg text-pink-400"
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="20"
                                    height="20"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    ><polyline points="4 7 4 4 20 4 20 7"
                                    ></polyline><line
                                        x1="9"
                                        y1="20"
                                        x2="15"
                                        y2="20"></line><line
                                        x1="12"
                                        y1="4"
                                        x2="12"
                                        y2="20"></line></svg
                                >
                            </div>
                            <h3 class="font-bold text-slate-200">å­—ä½“æ£€æµ‹</h3>
                        </div>
                        <div
                            class="prose prose-invert text-xs text-slate-400 mb-3"
                        >
                            æ£€æµ‹ç³»ç»Ÿå·²å®‰è£…çš„å­—ä½“ï¼Œä¸åŒè®¾å¤‡å­—ä½“åˆ—è¡¨å·®å¼‚æ˜æ˜¾ã€‚
                        </div>
                        <div
                            class="flex-1 flex flex-col px-3 py-2 bg-white/5 rounded-lg border border-white/10 text-xs font-mono text-slate-300 space-y-1 overflow-y-auto"
                        >
                            <div id="font-count">
                                <span class="text-slate-500">æ£€æµ‹åˆ°:</span>
                                <span
                                    class="text-pink-400"
                                    id="font-count-value">--</span
                                >
                                <span class="text-slate-500">ç§å­—ä½“</span>
                            </div>
                            <div
                                id="font-list"
                                class="text-[10px] text-slate-500 mt-1"
                            >
                                ç­‰å¾…æ£€æµ‹...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Documentation Content - Vertical Layout -->
            <div class="max-w-4xl mx-auto mt-16 space-y-16 text-slate-400">
                <!-- Section 1: Core Logic -->
                <section class="border-l-4 border-cyan-500 pl-6 space-y-4">
                    <h3 class="text-2xl font-bold text-white mb-4">
                        æ ¸å¿ƒåŸç† (How it works)
                    </h3>
                    <p class="leading-relaxed text-slate-300">
                        ç°ä»£æµè§ˆå™¨ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œä¼šåˆ©ç”¨åº•å±‚ç¡¬ä»¶ï¼ˆGPUã€å£°å¡ï¼‰åŠ é€Ÿæ¸²æŸ“å’Œè®¡ç®—ã€‚ç”±äºç¡¬ä»¶å‚å•†ã€é©±åŠ¨ç‰ˆæœ¬ã€æ“ä½œç³»ç»ŸæŠ—é”¯é½¿ç­–ç•¥çš„ä¸åŒï¼Œå“ªæ€•æ˜¯åŒæ ·çš„æ–‡å­—å’Œå›¾å½¢ï¼Œåœ¨ä¸åŒè®¾å¤‡ä¸Šæ¸²æŸ“å‡ºçš„äºŒè¿›åˆ¶æ•°æ®ä¹Ÿä¼šå­˜åœ¨è‚‰çœ¼æéš¾å¯Ÿè§‰çš„å¾®å°å·®å¼‚ã€‚
                    </p>
                    <p class="leading-relaxed text-slate-300">
                        <strong>Device Fingerprint</strong> é€šè¿‡ç»„åˆå¤šç§æµè§ˆå™¨ç‰¹å¾ï¼Œç”Ÿæˆä¸€ä¸ªèƒ½å¤Ÿå°½é‡å”¯ä¸€æ ‡è¯†è¯¥è®¾å¤‡çš„å“ˆå¸Œå­—ç¬¦ä¸²ã€‚æœ¬
                        SDK é‡‡ç”¨äº† <strong>5 ç§ä¿¡å·æº</strong>ï¼š
                    </p>
                    <ul class="space-y-2 ml-6 text-slate-300">
                        <li class="flex items-start gap-2">
                            <span class="text-orange-400 mt-1">ğŸ¨</span>
                            <div>
                                <strong class="text-orange-400"
                                    >Canvas æŒ‡çº¹</strong
                                > - ä¸åŒ GPU å’Œæ¸²æŸ“å¼•æ“ç»˜åˆ¶å›¾å½¢æ—¶çš„ç»†å¾®å·®å¼‚
                            </div>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-indigo-400 mt-1">ğŸ”Š</span>
                            <div>
                                <strong class="text-indigo-400"
                                    >Audio æŒ‡çº¹</strong
                                > - éŸ³é¢‘å †æ ˆå¤„ç†æ³¢å½¢çš„ç‰¹å¾å·®å¼‚
                            </div>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-emerald-400 mt-1">ğŸ’»</span>
                            <div>
                                <strong class="text-emerald-400"
                                    >ç¡¬ä»¶ç‰¹å¾</strong
                                > - CPU æ ¸å¿ƒæ•°ã€å†…å­˜ã€å¹³å°ã€è¯­è¨€ã€æ—¶åŒºç­‰
                            </div>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-purple-400 mt-1">ğŸ®</span>
                            <div>
                                <strong class="text-purple-400"
                                    >WebGL æŒ‡çº¹</strong
                                > - GPU ä¾›åº”å•†ã€æ¸²æŸ“å™¨å‹å·åŠ WebGL å‚æ•°
                            </div>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-pink-400 mt-1">ğŸ“</span>
                            <div>
                                <strong class="text-pink-400">å­—ä½“æ£€æµ‹</strong> -
                                ç³»ç»Ÿå·²å®‰è£…å­—ä½“åˆ—è¡¨ï¼ˆ20 ç§å¸¸è§å­—ä½“ï¼‰
                            </div>
                        </li>
                    </ul>
                    <div
                        class="bg-cyan-900/20 border border-cyan-500/30 rounded-lg p-4 mt-4"
                    >
                        <div class="flex items-center gap-2 mb-2">
                            <span class="text-cyan-400 text-xl">ğŸ”</span>
                            <strong class="text-cyan-300">ç†µå€¼ä¼°è®¡</strong>
                        </div>
                        <p class="text-sm text-slate-300">
                            5 ç§ä¿¡å·æºç»„åˆå¯æä¾›çº¦ <strong class="text-cyan-400"
                                >38 bits</strong
                            > çš„ç†µå€¼ï¼Œç†è®ºä¸Šå¯ä»¥åŒºåˆ†çº¦ <strong
                                class="text-cyan-400">2740 äº¿</strong
                            >å°ä¸åŒè®¾å¤‡ã€‚
                        </p>
                    </div>
                </section>

                <!-- Section 2: Usage Code -->
                <section class="border-l-4 border-emerald-500 pl-6 space-y-4">
                    <h3 class="text-2xl font-bold text-white mb-4">
                        ä½¿ç”¨æ–¹æ³• (Usage)
                    </h3>
                    <p class="text-sm mb-4 text-slate-400">
                        æœ¬ SDK å·²å¼€æºï¼Œæ‚¨å¯ä»¥ç›´æ¥åœ¨é¡¹ç›®ä¸­å¼•å…¥ä½¿ç”¨ã€‚
                        <a
                            href="https://github.com/ErpanOmer/erpanomer.github.io/tree/master/src/pages/tools/device-fingerprint/fingerprint-sdk.js"
                            target="_blank"
                            class="text-emerald-400 hover:underline"
                            >æŸ¥çœ‹ GitHub æºç ä»“åº“</a
                        >
                    </p>

                    <div
                        class="relative group bg-slate-900 rounded-xl border border-slate-700/50 shadow-inner overflow-hidden"
                    >
                        <div
                            class="absolute right-4 top-4 opacity-0 group-hover:opacity-100 transition-opacity"
                        >
                            <button
                                id="copy-code-btn"
                                class="px-3 py-1.5 bg-slate-800 text-slate-300 text-xs rounded hover:bg-slate-700 border border-slate-600 transition-colors"
                            >
                                å¤åˆ¶ä»£ç 
                            </button>
                        </div>
                        <pre
                            class="px-6 pb-6 overflow-x-auto text-sm font-mono leading-relaxed text-slate-300">
                            <Code class="language-js" id="code-snippet" code={code} lang="js" style={"background-color: transparent"} /></pre>
                    </div>
                </section>

                <!-- Section 3: Privacy & Limits -->
                <section class="border-l-4 border-yellow-500 pl-6 space-y-4">
                    <h3 class="text-2xl font-bold text-white mb-4">
                        éšç§ä¸å±€é™ (Privacy & Limits)
                    </h3>
                    <ul class="space-y-4 text-slate-300">
                        <li class="bg-black/20 p-4 rounded-lg">
                            <div class="font-bold text-cyan-400 mb-1">
                                âœ… éšç§å‹å¥½
                            </div>
                            <div class="text-sm">
                                SDK ä»…é‡‡é›†è®¾å¤‡ç¡¬ä»¶å±æ€§ï¼ˆå¦‚
                                GPUã€å£°å¡å¤„ç†ç‰¹å¾ï¼‰å’Œç³»ç»Ÿé…ç½®ï¼Œä¸æ”¶é›†ä»»ä½•
                                IPã€åœ°ç†ä½ç½®æˆ–å…·ä½“è®¾å¤‡è´¦æˆ·ç­‰æ•æ„Ÿéšç§ä¿¡æ¯ã€‚
                            </div>
                        </li>
                        <li class="bg-black/20 p-4 rounded-lg">
                            <div class="font-bold text-cyan-400 mb-1">
                                âœ… ç¨³å®šæŒä¹…
                            </div>
                            <div class="text-sm">
                                ä¸ä¾èµ– <code>cookie</code> æˆ– <code
                                    >localStorage</code
                                >ï¼Œæ¸…ç†ç¼“å­˜æˆ–ä½¿ç”¨éšèº«æ¨¡å¼é€šå¸¸ä¸ä¼šæ”¹å˜
                                IDã€‚é‡‡é›†é€»è¾‘å·²é’ˆå¯¹å¤ä»¤æ—¶ç­‰ç¯å¢ƒæ³¢åŠ¨è¿›è¡Œäº†ç¨³å®šæ€§ä¼˜åŒ–ã€‚
                            </div>
                        </li>
                        <li
                            class="bg-black/20 p-4 rounded-lg border border-yellow-500/20"
                        >
                            <div class="font-bold text-yellow-400 mb-1">
                                âš  æŠ—æŒ‡çº¹æµè§ˆå™¨
                            </div>
                            <div class="text-sm">
                                éƒ¨åˆ†éšç§æµè§ˆå™¨ï¼ˆå¦‚ Torã€Braveï¼‰æˆ– Safari
                                çš„â€œé˜»æ­¢è·¨ç«™è·Ÿè¸ªâ€åŠŸèƒ½ä¼šæ•…æ„ä¸º Canvas/Audio
                                æ·»åŠ éšæœºå™ªç‚¹ã€‚è¿™ä¼šå¯¼è‡´æ¯æ¬¡ç”Ÿæˆçš„ ID
                                éƒ½ä¸ä¸€æ ·ã€‚è¿™æ˜¯æ­£å¸¸çš„éšç§ä¿æŠ¤æœºåˆ¶ã€‚
                            </div>
                        </li>
                    </ul>
                </section>
            </div>
            <!-- PROMOTION BANNER -->
            <section
                class="max-w-4xl mx-auto my-8 md:mt-12 overflow-hidden rounded-2xl bg-gradient-to-r from-indigo-600 via-blue-600 to-indigo-700 p-[1px] shadow-xl shadow-indigo-500/20"
            >
                <div
                    class="bg-slate-900 rounded-[15px] p-4 md:p-6 flex flex-col md:flex-row items-center justify-between gap-6"
                >
                    <div class="flex items-center gap-4">
                        <div
                            class="hidden sm:flex w-12 h-12 rounded-full bg-indigo-500/20 items-center justify-center flex-shrink-0"
                        >
                            <svg
                                class="w-6 h-6 text-indigo-400"
                                fill="none"
                                stroke="currentColor"
                                viewBox="0 0 24 24"
                                ><path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.175 0l-3.976 2.888c-.783.57-1.838-.197-1.539-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"
                                ></path></svg
                            >
                        </div>
                        <div>
                            <h3 class="text-base font-bold text-white">
                                è§‰å¾—è¿™ä¸ªå·¥å…·å¥½ç”¨ï¼Ÿ
                            </h3>
                            <p class="text-sm text-slate-400 mt-0.5">
                                ä½ çš„ Star
                                æ˜¯å¯¹æˆ‘æŒç»­å¼€å‘çš„æœ€å¤§é¼“åŠ±ï¼ç‚¹å‡»å³ä¾§æŒ‰é’®å‰å¾€
                                GitHub æ”¯æŒæˆ‘ã€‚
                            </p>
                        </div>
                    </div>
                    <a
                        href="https://github.com/ErpanOmer/erpanomer.github.io"
                        target="_blank"
                        class="group relative flex items-center gap-2 px-6 py-3 bg-white text-slate-900 rounded-xl font-bold transition-all hover:scale-105 hover:shadow-lg active:scale-95 whitespace-nowrap overflow-hidden"
                    >
                        <div
                            class="absolute inset-0 bg-gradient-to-r from-indigo-500 to-purple-600 opacity-0 group-hover:opacity-10 transition-opacity"
                        >
                        </div>
                        <svg
                            class="w-5 h-5 text-yellow-500 fill-current"
                            viewBox="0 0 24 24"
                            ><path
                                d="M12 .587l3.668 7.568 8.332 1.151-6.064 5.828 1.48 8.279-7.416-3.967-7.417 3.967 1.481-8.279-6.064-5.828 8.332-1.151z"
                            ></path></svg
                        >
                        <span>Give me a Star</span>
                    </a>
                </div>
            </section>
        </div>
    </div>
</BaseLayout>

<script>
    import { generateFingerprint } from "./fingerprint-sdk.js";

    // UI Elements
    const btn = document.getElementById("generate-btn");
    const resultContainer = document.getElementById("result-container");
    const breakdownGrid = document.getElementById("breakdown-grid");

    const idDisplay = document.getElementById("device-id-display");
    const entropyDisplay = document.getElementById("entropy-score");
    const timeDisplay = document.getElementById("gen-time");
    const copyBtn = document.getElementById("copy-btn");
    const copyCodeBtn = document.getElementById("copy-code-btn");

    // Component outputs
    const canvasImg = document.getElementById("signal-canvas-img");
    const canvasHash = document.getElementById("signal-canvas-hash");
    const audioHash = document.getElementById("signal-audio-hash");
    const hwCores = document.getElementById("hw-cores");
    const hwMem = document.getElementById("hw-mem");
    const hwPlatform = document.getElementById("hw-platform");
    const hwLanguage = document.getElementById("hw-language");
    const hwColorDepth = document.getElementById("hw-colordepth");
    const hwPixelDepth = document.getElementById("hw-pixeldepth");
    const hwTimezone = document.getElementById("hw-timezone");

    // WebGL elements
    const webglVendor = document.getElementById("webgl-vendor");
    const webglRenderer = document.getElementById("webgl-renderer");

    // Font elements
    const fontCountValue = document.getElementById("font-count-value");
    const fontList = document.getElementById("font-list");

    // Core Function
    async function runGeneration() {
        try {
            // Manual trigger UI state
            if (btn) btn.textContent = "ç”Ÿæˆä¸­...";

            // Battery removed as per requirements (Phase 3)
            const result = await generateFingerprint();

            console.log("Fingerprint Result:", result);

            // 1. Update Main ID (Directly from SDK, no prefix)
            if (idDisplay) {
                idDisplay.innerHTML = `<span class="text-cyan-50">${result.deviceId}</span>`;
            }

            if (entropyDisplay)
                entropyDisplay.textContent = result.entropyScore;
            if (timeDisplay) timeDisplay.textContent = result.generationTimeMs;

            // 2. Update Canvas - Handle new structure
            if (result.details && result.details.canvasDataUrl) {
                if (canvasImg) canvasImg.src = result.details.canvasDataUrl;
                if (canvasHash) canvasHash.textContent = "æ•°æ®å·²æ•è·";
            } else if (result.details && result.details.canvasError) {
                if (canvasHash) canvasHash.textContent = "è¢«æ‹¦æˆª/é”™è¯¯";
            } else if (
                result.components.canvas &&
                !String(result.components.canvas).startsWith("ERROR_")
            ) {
                if (canvasHash) canvasHash.textContent = "æ•£åˆ—å·²è®¡ç®—";
            } else {
                if (canvasHash) canvasHash.textContent = "è¢«æ‹¦æˆª/é”™è¯¯";
            }

            // 3. Update Audio
            if (audioHash)
                audioHash.textContent = `æ ·æœ¬å“ˆå¸Œ: ${result.components.audio}`;

            // 4. Update Hardware
            // Use structured details provided by new SDK
            if (result.details && result.details.hardware) {
                const h = result.details.hardware;
                if (hwCores) {
                    const coresValue = hwCores.querySelector("span:last-child");
                    if (coresValue)
                        coresValue.textContent = String(h.concurrency);
                }
                if (hwMem) {
                    const memValue = hwMem.querySelector("span:last-child");
                    if (memValue)
                        memValue.textContent =
                            h.memory === "unknown" ? "æœªçŸ¥" : `${h.memory} GB`;
                }
                if (hwPlatform) {
                    const platformValue =
                        hwPlatform.querySelector("span:last-child");
                    if (platformValue)
                        platformValue.textContent = String(h.platform);
                }
                if (hwLanguage) {
                    const langValue =
                        hwLanguage.querySelector("span:last-child");
                    if (langValue) langValue.textContent = String(h.language);
                }
                if (hwColorDepth) {
                    const colorValue =
                        hwColorDepth.querySelector("span:last-child");
                    if (colorValue)
                        colorValue.textContent = `${h.colorDepth} bit`;
                }
                if (hwPixelDepth) {
                    const pixelValue =
                        hwPixelDepth.querySelector("span:last-child");
                    if (pixelValue)
                        pixelValue.textContent = `${h.pixelDepth} bit`;
                }
                if (hwTimezone) {
                    const tzValue = hwTimezone.querySelector("span:last-child");
                    if (tzValue)
                        tzValue.textContent = `UTC${h.timezoneOffset > 0 ? "-" : "+"}${String(Math.abs(h.timezoneOffset / 60))}`;
                }
            } else if (result.components.hardware) {
                // Fallback for older SDK version or error
                const parts = String(result.components.hardware).split("|");
                if (hwCores) {
                    const coresValue = hwCores.querySelector("span:last-child");
                    if (coresValue) coresValue.textContent = parts[0];
                }
                if (hwMem) {
                    const memValue = hwMem.querySelector("span:last-child");
                    if (memValue)
                        memValue.textContent =
                            parts[1] === "unknown" ? "æœªçŸ¥" : `${parts[1]} GB`;
                }
                if (hwPlatform) {
                    const platformValue =
                        hwPlatform.querySelector("span:last-child");
                    if (platformValue)
                        platformValue.textContent = parts[2] || "æœªçŸ¥";
                }
                if (hwLanguage) {
                    const langValue =
                        hwLanguage.querySelector("span:last-child");
                    if (langValue) langValue.textContent = parts[3] || "æœªçŸ¥";
                }
                if (hwColorDepth) {
                    const colorValue =
                        hwColorDepth.querySelector("span:last-child");
                    if (colorValue) colorValue.textContent = `${parts[4]} bit`;
                }
                if (hwPixelDepth) {
                    const pixelValue =
                        hwPixelDepth.querySelector("span:last-child");
                    if (pixelValue) pixelValue.textContent = `${parts[5]} bit`;
                }
                if (hwTimezone) {
                    const tzValue = hwTimezone.querySelector("span:last-child");
                    if (tzValue && parts[6]) {
                        const offset = parseInt(parts[6]);
                        tzValue.textContent = `UTC${offset > 0 ? "-" : "+"}${Math.abs(offset / 60)}`;
                    }
                }
            }

            // 5. Update WebGL
            if (result.details && result.details.webgl) {
                const webglData = result.details.webgl.split("|");
                if (webglVendor) {
                    const vendorText =
                        webglVendor.querySelector("span:last-child");
                    if (vendorText)
                        vendorText.textContent =
                            webglData[4] || webglData[0] || "æœªçŸ¥";
                }
                if (webglRenderer) {
                    const rendererText =
                        webglRenderer.querySelector("span:last-child");
                    if (rendererText)
                        rendererText.textContent =
                            webglData[5] || webglData[1] || "æœªçŸ¥";
                }
            } else if (
                result.components.webgl &&
                !String(result.components.webgl).startsWith("ERROR_")
            ) {
                const webglData = result.components.webgl.split("|");
                if (webglVendor) {
                    const vendorText =
                        webglVendor.querySelector("span:last-child");
                    if (vendorText)
                        vendorText.textContent =
                            webglData[4] || webglData[0] || "æœªçŸ¥";
                }
                if (webglRenderer) {
                    const rendererText =
                        webglRenderer.querySelector("span:last-child");
                    if (rendererText)
                        rendererText.textContent =
                            webglData[5] || webglData[1] || "æœªçŸ¥";
                }
            }

            // 6. Update Fonts
            if (
                result.details &&
                result.details.fonts &&
                result.details.fonts.length > 0
            ) {
                if (fontCountValue)
                    fontCountValue.textContent = result.details.fonts.length;
                if (fontList)
                    fontList.textContent = result.details.fonts.join(", ");
            } else if (
                result.components.fonts &&
                !String(result.components.fonts).startsWith("ERROR_")
            ) {
                const fonts = result.components.fonts
                    .split("|")
                    .filter((f) => f && f !== "none");
                if (fontCountValue) fontCountValue.textContent = fonts.length;
                if (fontList)
                    fontList.textContent =
                        fonts.length > 0 ? fonts.join(", ") : "æ— æ£€æµ‹åˆ°å­—ä½“";
            }

            // 7. Reveal UI
            if (resultContainer) {
                resultContainer.classList.remove("hidden");
                resultContainer.classList.remove("translate-y-4");
                // Fade in effect
                setTimeout(() => {
                    resultContainer.style.opacity = "1";
                }, 50);
            }
            if (breakdownGrid) {
                breakdownGrid.classList.remove("hidden");
                setTimeout(() => {
                    breakdownGrid.style.opacity = "1";
                }, 50);
            }

            // Reveal manual trigger button
            if (btn) {
                btn.textContent = "é‡æ–°ç”Ÿæˆ";
                btn.classList.remove("hidden");
            }
        } catch (e) {
            console.error(e);
            if (idDisplay)
                idDisplay.innerHTML =
                    "<span class='text-red-400'>ç”Ÿæˆå¤±è´¥</span>";
        }
    }

    // Auto-run on mount
    // Astro View Transitions compatibility
    document.addEventListener("astro:page-load", runGeneration);
    // Fallback
    if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", runGeneration);
    } else {
        runGeneration(); // Run immediately if ready
    }

    // Manual trigger
    if (btn) {
        btn.addEventListener("click", runGeneration);
    }

    // Copy ID
    if (copyBtn) {
        copyBtn.addEventListener("click", () => {
            const text = idDisplay.innerText;
            if (text && !text.includes("...")) {
                navigator.clipboard.writeText(text);
                const original = copyBtn.innerHTML;
                copyBtn.innerHTML =
                    '<span class="text-emerald-400 font-bold text-xs" style="position: absolute; left: 50%; top: 50%; transform: translate(-60%, -50%); width: 100px;">å·²å¤åˆ¶</span>';
                setTimeout(() => (copyBtn.innerHTML = original), 2000);
            }
        });
    }

    // Copy Code
    if (copyCodeBtn) {
        copyCodeBtn.addEventListener("click", () => {
            const code = document.getElementById("code-snippet")?.innerText;
            if (code) {
                navigator.clipboard.writeText(code);
                const original = copyCodeBtn.innerText;
                copyCodeBtn.innerText = "å·²å¤åˆ¶!";
                copyCodeBtn.classList.add(
                    "text-emerald-400",
                    "border-emerald-500/50",
                );
                setTimeout(() => {
                    copyCodeBtn.innerText = original;
                    copyCodeBtn.classList.remove(
                        "text-emerald-400",
                        "border-emerald-500/50",
                    );
                }, 2000);
            }
        });
    }
</script>
